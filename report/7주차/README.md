# 캡스톤 7주차 보고서

## 1. 기존 SADS 모델 수정

앞서 저희의 모델은 공격자와 유저가 가까울 때 수신 받는 두 RSSI 값이 매우 비슷하기 때문에 스푸핑 공격을 감지할 수는 있지만 공격자의 패킷을 특정할 수 없다는 한계점이 있었습니다. 때문에 이러한 한계점을 극복하기 위해서 Unicast Phase라는 새로운 단계를 Detection Phase 단계 이전에 추가하기로 결정했습니다. 해당 Unicast Phase에서는 공격자가 감지하고 파악하기 힘든 고유 식별자를 이용하는 것을 목적으로 삼았으며, 이를 위해 저희는 광고 패킷 내부 정보 중 Major와 Minor 식별값을 활용하기로 결정했습니다. 또한 광고 패킷을 방송하는 BLE의 특성 상 저희는 해당 식별자 정보를 공격자가 알아내지 못하게끔 ECC와 Elgamal 기법을 이용해 서버와 사용자 사이의 암호화 통신을 구상했습니다. 이에 따라서 SADS 모델을 수정하였습니다.

## 2. Major, Minor 정보 사용에 대한 한계점

Major와 Minor 정보를 고유 식별자로 이용한 SADS 모델에 대한 실험을 진행함으로써 저희는 한가지 큰 모순점을 발견할 수 있었습니다. 사용자와 서버만 식별할 수 있는 고유 식별자로써 Major, Minor 정보를 사용한다는 것이 목적이었지만 ECC와 Elgamal을 이용해 사용자와 서버 사이의 암호화 통신을 구축해도 결국엔 광고 패킷을 방송하는 특징으로 인해, 실험 결과 공격자 측에서도 방송되고 있는 사용자의 광고 패킷을 식별할 수 있는 사실을 확인할 수 있었습니다. 따라서 공격자 또한 해당 광고 패킷 정보를 그대로 복사함으로써 사용자와 동일한 광고 패킷으로 서버에 접근할 수 있게 됩니다. 결론적으로 입출력에만 의존되어 작동되는 서버와 사용자의 BLE 기기에서 암호화의 의미가 사라지는 모순점을 파악하였으며, 고유 식별자로써 Major, Minor 정보를 이용할 수 없다는 것을 확인할 수 있었습니다. 따라서 저희는 Unicast Phase에 사용자의 BLE 기기와 서버 사이의 규칙을 생성하여 일대일 통신을 가능하게 하는 새로운 방안을 탐색하였습니다.

## 3. 일대일 통신을 위한 랜덤 정수 리스트 활용 방법

앞서 실험을 통해 저희는 광고 패킷을 방송하는 BLE 특성상 광고 패킷 내부 정보만으로는 동일한 정보로 들어오는 공격자의 광고 패킷을 구분하기 어렵다는 것을 확인했습니다. 따라서 정상 사용자가 송신하는 광고 패킷과 공격자가 송신하는 광고 패킷에서 두 광고 패킷을 구분할 수 있는 정보가 무엇이 있는지 생각해보았습니다.

* RSSI (Received Signal Strength Indicator)
    * 광고 패킷을 수신하는 Anchor Point로부터 떨어져 있는 거리에 따라 달라지는 광고 패킷 내부의 값
    * 앞서 Detection Phase 단계에서 활용한 정보
    * 사용자의 BLE 기기와 공격자의 BLE 기기와 Anchor Point로부터 동일한 거리에 떨어져 있는 경우 구분할 수 없는 한계점 존재

* 수신 시간 (Received Time)
    * Anchor Point로 광고 패킷이 수신될 때 측정되는 수신 시간 (= 현재 시간)

따라서 저희는 수신 시간을 이용해 사용자와 서버간의 일대일 통신을 구상하는 방법을 모색하던 중 약속 시간이라는 방법을 떠올렸습니다. 자세하게 말씀드리면, 사용자와 서버 서로 약속된 시간에만 광고 패킷을 송수신하고 약속된 시간이 아니면 광고 패킷을 송수신하지 않는 개념입니다. 더불어 일정하게 정해져있는 약속 시간 리스트는 공격자가 인지하고 파악하기 쉽기 때문에 보안 취약점이 존재하므로 시간 정보들을 랜덤하게 생성하는 방안으로 구상했습니다.

## 4. 추가적으로 고려해야할 부분

사용자와 서버 사이에 약속 시간을 설정하는 개념이므로 당연하게도 사용자와 서버는 동일한 약속 시간 리스트를 가지고 있어야 합니다. 하지만 위에서 언급드린 것처럼 일정하게 정해져있는 약속 시간 리스트는 보안 취약점이 존재하기 때문에 저희는 랜덤한 값으로 약속 시간 리스트를 생성합니다. 따라서 랜덤하게 생성되는 약속 시간 리스트여도 서버와 사용자는 동일한 약속 시간 리스트를 가지고 있어야 하기 때문에 저희는 같은 양쪽에서 동일한 랜덤 시드로 약속 시간 리스트를 생성합니다. 또한 공격자로부터 랜덤 약속 시간 리스트를 생성하기 위한 랜덤 시드 값을 보호해야 하므로 앞서 고유 식별자를 안전하게 전송하기 위해 사용한 ECC와 Elgamal 기술을 이용해 암호화 및 복호화를 랜덤 시드 값에 적용합니다.

## 5. 랜덤 약속 시간 리스트의 기대 효과

단순히 스푸핑 공격을 탐지하는 것 뿐만 아니라 약속되지 않은 시간에 수신되는 공격자의 광고 패킷을 확인할 수 있어, 결론적으로 사용자와 공격자의 BLE 기기의 위치가 가까울 때 공격자의 광고 패킷을 구분할 수 없는 한계점을 해결할 수 있습니다.