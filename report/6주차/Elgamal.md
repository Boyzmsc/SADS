# Elgamal Algorithm

## Elgamal 알고리즘이란 ?

엘가말(Elgamal)은 1985년에 발명된 공개키 암호 중 하나이며 디피-헬먼 (Diffie-Hellman) 키 교환 알고리즘을 바탕으로 한 공개키 암호 방식입니다. 디피-헬먼 키 교환 알고리즘은 암호키를 교환하는 하나의 방법으로 두 사용자가 암호화되지 않은 통신망을 통해 공통의 비밀키를 공유할 수 있도록 해줍니다. 또한 엘가말은 이산대수 문제의 어려움에 근거해서 만든 시스템입니다.

## 이산대수 문제의 어려움

<img src="https://latex.codecogs.com/svg.image?y&space;=&space;g^x\,mod\;\,p" title="https://latex.codecogs.com/svg.image?y = g^x\,mod\;\,p" />

위에 나타낸 수식에서 `p`가 소수이고 `g`가 원시 원소일 때 `g`, `x`, `p`값을 이용하여 `y` 값을 구하는 것은 쉽지만 `g`, `y`, `p`값을 이용하여 `x`값을 구하기는 어렵습니다.

## Elgamal 알고리즘 방식

이러한 이산대수 문제의 어려움을 기반으로 엘가말은 다음과 같은 방식으로 진행됩니다.

![elgamal](https://user-images.githubusercontent.com/28584213/130356448-922537e5-fd90-464a-b022-ce16046bb880.png)

1. 정보를 받을 사용자 (BOB)측에서 소수 `p`, 원시 원소인 `e`<sub>`1`</sub>를 선택하고 공개키로 설정합니다.

2. 이후 개인키 `d`를 선택하고 선택한 값들을 기반으로 `e`<sub>`2`</sub>값을 구하고 해당 값 또한 공개키로 설정합니다.

3. 정보를 보낼 사용자 (ALICE)는 BOB에게 공개키들을 전달받고 난수 `r`을 선택한 뒤 평문의 암호화를 진행합니다.

4. 해당 암호문을 BOB에게 보내게 되면 BOB은 개인키인 `d`를 이용해 복호화하여 ALICE가 보낸 평문 `P`를 확인합니다.

## ECC를 기반으로 한 Elgamal 알고리즘 방식

저희의 모델은 타원 곡선 암호화를 사용하기 때문에 타원 곡선 암호화를 적용한 Elgamal 알고리즘을 사용합니다.

![ecc elgamal](https://user-images.githubusercontent.com/28584213/130356446-29d75a81-ad36-4174-a268-a2fc691dc4e8.png)

1. 정보를 받을 사용자 (BOB)측에서 타원 곡선 상의 유한체를 정의하기 위한 매개변수 `E`<sub>`p`</sub>를 선택하고 공개키로 설정합니다.

2. 유한체의 범위를 지정하는 매우 큰 소수인 `p` 이하의 수 중 무작위의 소수인 `d`를 선택하고 개인키로 설정합니다.

3. 암호화에 사용되는 갈루아 필드 (Galois Field) 위의 무작위 점 `e`<sub>`1`</sub>을 선택하고 공개키로 설정합니다.

4. 선택한 값들을 기반으로 `e`<sub>`2`</sub>값을 구하고 해당 값 또한 공개키로 설정합니다.

5. 정보를 보낼 사용자 (ALICE)는 BOB에게 공개키들을 전달받고 난수 `r`을 선택한 뒤 평문의 암호화를 진행합니다.

6. 해당 암호문을 BOB에게 보내게 되면 BOB은 개인키인 `d`를 이용해 복호화하여 ALICE가 보낸 평문 `P`를 확인합니다.

## Elgamal 알고리즘의 보안성

위의 방식에서, 제 3자가 공개키 정보들과 암호문을 모두 알고 있더라도 평문 `P`를 알기 위해서는 개인키 (비밀키)를 알아야 합니다. 하지만 개인키를 구하는 것은 이산 로그 방정식에서의 해를 구하는 것과 같으므로 보안이 강한 특징을 가지고 있습니다. 그리고 소수인 `p`값이 클수록 해를 구하는 것이 더 어려운 특징 또한 가지고 있습니다.